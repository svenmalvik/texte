# Docker kommer sjeldent alene.
**Når vi starter et prosjekt med Docker, så er ofte mange andre teknologier involvert, teknologier som vi i starten kanskje ikke hadde regnet med. I dette innlegget vil jeg fortelle om mine synspunkter om Docker, og hva man bør tenke på før man starter med Docker.**  

## Docker for privatbruk 
For noen år siden skrev jeg et Python skript som skulle sørge for å få meg flere Twitter følgere. Skriptet hadde noen avhengigheter til moduler som jeg installerte med pip - en pakkemanager for Python. Jeg husker at installasjonen av Python og pip var humpete. Ubuntu versjonen jeg brukte kom med Python 2, men jeg trengte Python 3 og en tilsvarende versjon av pip. Det tok noe tid før alt var på plass, nettopp fordi jeg hadde ikke brukt disse teknologier før. Jeg puttet skriptet og avhengighetene inn ett Docker image. Slik unngikk jeg installasjon senere en gang til. 

To år senere var jeg motivert nok til å fortsette med mitt Twitter prosjektet. Jeg husket så vidt at jeg brukte Python og at jeg hadde alt lagt inn i et Docker image, og lagret på min Docker Hub side. Jeg slapp å bruke mye tid på å finne ut av hvordan jeg skulle installere, konfigurere, starte og stoppe skriptet, dvs. Docker imaget. Det eneste jeg trengte å gjøre var å installere Docker på min maskin. Docker hjalp meg å komme raskt i gang. Men, hvordan ser det ut hos kundene våre som kjører de store prosjektene?

## Docker i mindre bedrifter
Hos kundene våre er det ikke så enkelt å bruke kun Docker for deres tjenester. Tjenestene krever ofte høy tilgjengelighet og flere Docker hosts er nødvendig for å kunne skalere disse. I så fall trengs det verktøy som kan håndtere dette. Kubernetes er et slikt verktøy og som har blitt veldig populært de siste årene. Dessverre er dette ikke nok. i et høytilgjengeligmiljø trenger vi en lastbalanserer, logging- og monitoreringsverktøy og konfigurasjonsstyringsverktøy. Det jeg vil si er følgende: Docker kommer sjeldent alene. En velfungerende Dockerplatform krever mye kunnskap om mange andre teknologier enn Docker. 

Høst 2016 startet jeg i DevOps avdelingen hos Sopra Steria. Jeg skulle hjelpe en kunde med lage en Dockerplattform hvor flere mindre store tjenester skulle kjøre på. Vi hadde mange utfordringer. Oppgaven var veldig gøy, men når jeg tenker tilbake, så spør jeg meg ofte om det var verdt det. Oppgaven var enorm, og det føltes som å bygge et gigantisk slott får en trebarnsfamilie. Å drifte en Dockerplatform er en fulltidsjobb for to eller flere personer. Å være bevist på konsekvensene Docker medfører er en viktig forutsetning for valget man treffer. 

## Docker Platform as a Service
Jeg påstår, og det er sikkert noen som er uenig med meg, at Docker som Plattform as a Service (DPaaS) er en forutsetning for at et kundeprosjekt kan og bør bruke Docker. DPaas er en forutsetning for at utviklere kan fokusere 100% på brukerhistorier. NAV har utviklet en slik plattform, NAIS - NAV Application Infrastructure Service. Plattformen består av Docker - selvfølgelig -, Kubernetes, Træfik, Grafana, InfluxDB og noen andre teknologier. NAIS vedlikeholdes av et team på 4-6 personer som sørger for at plattformen er enkelt å bruke og at den alltid er tilgjengelig. For de som deployer sine tjenester til NAIS, er plattformen en forenkling av hverdagen. 

Før NAIS ble utviklet, så måtte utviklerne deploye en tjenesteinstans til en egen JBoss server hvor det kjørtes kun en applikasjon på. Kjørte man altså flere instanser av samme applikasjon, så trengte man flere JBoss servere. I dag, når vi ruller ut flere tjenesteinstanser til NAIS, så spres disse utover alle NAIS hostene, automatisk. Skulle en host ha problemer og må restartes - det betyr at Docker kontainerne som kjører applikasjonene vil stoppes - så starter NAIS disse på en annen host, også automatisk. 

DPaaS gjør at utviklere er mindre avhengig av de menneskene som tidligere har driftet JBoss. I tillegg får utviklere mer ansvar. Dockerfilen som beskriver hvordan en applikasjon skal kjøre inn i en kontainer, er nå blitt en del av applikasjonsprosjektet. Filen ligger sammen med en NAIS konfigurasjonsfil og all applikasjonskode inn i prosjektet. Fordelen er at alt ligger sammen i ett og samme prosjekt. Slikt vil utviklere kunne ta mer eierskap - you build it, you run it.

## Konklusjon
Jeg er glad for at jeg kan bruke Docker privat. Teknologien hjelper meg å ta være på mine applikasjoner over tid. Jeg forholder meg til en teknologi. Hos kundene våre ønsker jeg helst et velfungerende og brukervennlig grensesnitt for Docker, slik at jeg kan fokusere på brukerhistorier og selve tjenestene som skal lages. NAIS er en slik plattform. Den er veldig tilpasset NAV, men det kommer stadig flere tilsvarende Dockerplatformer som er minst like gøy å jobbe med.
