# Docker kommer sjeldent alene.
**Når vi bruker Docker, så er det ofte mange andre teknologier involvert. Men, når bør vi egentlig bruke Docker, og når bør vi heller la være? I dette innlegget forteller jeg om mine erfaringer med Docker.**

Høst 2016 startet jeg i DevOps avdelingen hos Sopra Steria. Jeg skulle hjelpe en kunde med lage en Dockerplattform hvor flere mindre store tjenester skulle kjøre på. Det var for noen år siden, og plattformen brukes fortsatt. Når jeg tenker tilbake til alle utfordringene vi hadde, så spør jeg meg ofte om det var verdt det. Oppgaven var enorm. Det føltes som å bygge et slott får en trebarnsfamilie. I dette innlegget vil jeg fortelle om mine synspunkter om Docker, og hva man bør tenke på før man starter med Docker. 
## Docker for privatbruk 
For noen år siden skrev jeg et Python program. Programmet skulle sørge for å få flere Twitter følgere. Jeg vet, hvorfor skulle man lage et slikt program i det hele tatt? Programmet hadde noen avhengigheter til Python moduler som jeg installerte med Pip. Jeg husker at installasjonen av Python og Pip ikke var rett fram. Ubuntu versjonen jeg brukte kom med Python 2, men jeg trengte Python 3 og en tilsvarende Pip versjon. Det tok noe tid før alt var på plass. Som ofte er det teknologier som man ikke bruker hver dag som vi bruker mest tid på. Derfor puttet jeg mit program inn ett Docker image. På den måten unngå jeg installasjon av Python, Pip og andre moduler senere en gang til. 

To år senere trengte jeg dette programmet igjen. Jeg husket så vidt at jeg brukte Python og at jeg hadde puttet det inn i et Docker image. Jeg hadde lagret imaget på min Docker Hub side, så jeg slapp å bruke mye tid på å finne ut av hvordan jeg skulle installere, konfigurere, starte og stoppe applikasjonen/imaget. Det eneste jeg trengte å gjøre var å installere Docker. Docker hjalp meg å komme raskt i gang igjen. For meg har det vært veldig nyttig og jeg kommer til å putte min neste applikasjon inn i et Docker image også. Men, hvordan ser det ut hos kundene våre som kjører store prosjekter?
## Docker i mindre bedrifter
Hos kundene våre vil det nok ikke være så enkelt. De har ofte tjenester som krever høy tilgjengelighet. Det betyr at kundene trenger flere Docker hosts hvor det kjøres alltid flere tjenesteinstanser i parallel. Dette må styres, av noe(n). Kubernetes har vokst til en slags paraply for Docker som er blitt veldig populær. Dessverre holder det ikke å installere Kubernetes og Docker. I et høytilgjengeligmiljø kommer det andre tekonologier i tillegg, lastbalanserer, logging- og monitoreringsverktøy er noen av de. Det jeg vil si er følgende: Docker kommer nesten aldri alene. En velfungerende Dockerplattform krever mye kunnskap om mange andre teknologier enn Docker. De aller fleste utviklere har mye kunnskap om Git, Maven og Jenkins, og mange av dem kan også skrive en Dockerfil. De som ikke kan det lærer det fort. Men, å drifte en Dockerplattform er en fulltidsjobb for to eller flere personer. Det er derfor viktig å være bevist på om man vil bruke Docker eller ikke. 
## Docker Plattform as a Service
Jeg vil påstå at, og det er sikkert noen som er uenig nå, Docker som Plattform as a Service (DPaaS) er en forutsetning for at et kundeprosjekt bør bruke Docker. NAV har utviklet en slik plattform, NAIS for NAV Application Infrastructure Service. Plattformen består av Docker - selvfølgelig -, Kubernetes, Træfik, Grafana, InfluxDB og noen andre teknologier. NAIS vedlikeholdes av et team på 4-6 personer som sørger for at plattformen er enkelt å bruke og at den er alltid tilgjengelig. For de som deployer sine tjenester er NAIS en forenkling av hverdagen. Før NAV hadde utviklet NAIS, deployet vi hver tjenesteinstans til en egen JBoss server som kjørte på sin egen host. Mange JBoss servere på mange hosts betyr mer konfigurasjon som betyr mer ressursbruk og høyere kostnader. Når vi nå ruller ut en tjeneste med for eksempel 4 instanser, så sprer NAIS disse utover sine hosts, helautomatisk. Skulle en host ha problemer og må restartes - det betyr at Docker kontainerne som kjører applikasjonene stoppes - så starter NAIS (Kubernetes) disse på en annen host, også automatisk. 

DPaaS gjør at utviklerne er mindre avhengig av de som før måtte drifte JBoss serverne og tilhørende hosts. Med DPaaS får utviklerne mer ansvar. Dockerfilen som beskriver hvordan en applikasjon skal kjøre, er blitt en del applikasjonsprosjektet. Dockerfilen ligger sammen med en NAIS konfigurasjonsfil sammen med all den andre applikasjonskoden. En applikasjon er mer enn bare kode. Den skal kunne kjøre. Jeg tenker er det er en bra utvikling fordi vi vil ta full eierskap - you build it, you run it.

## Konklusjon
Jeg er glad for at jeg kan bruke Docker privat. Teknologien hjelper meg å ta være på mine applikasjoner. Jeg forholder meg til kun en teknologi til slutt. Hos kundene våre ønsker jeg helst et velfungerende og brukervennlig grensesnitt for Docker. Slik kan jeg som utvikler fokusere på tjenestene jeg skal lage. NAIS er en slik plattform, og som er veldig tilpasset NAV, men heldigvis for oss, så kommer der stadig flere tilsvarende Dockerplattformer som er like gøy å jobbe med.
