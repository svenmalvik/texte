# Docker kommer sjeldent alene.
**Når vi bruker Docker, så er det ofte slik at mange andre teknologier blir involvert. Spørsmålet som stiller seg da er om det kan bli for mye når vi starter memd Docker. I dette innlegget vil jeg fortelle om mine erfaringer med Docker.**

Høst 2016 startet jeg i DevOps avdelingen hos Sopra Steria. Jeg skulle hjelpe en kunde med lage en Dockerplattform hvor flere mindre store tjenester skulle kjøre på. Det var for noen år siden. Når jeg tenker tilbake til alle utfordringene vi hadde og hvilken gevinst vi oppnådde, så spør jeg meg ofte om det var verdt det. Oppgaven var enorm. Det føltes som å bygge et slott får en trebarnsfamilie. I dette innlegget vil jeg fortelle om mine synspunkter om Docker, og hva man bør tenke på før man starter med Docker. 
## Docker for privatbruk 
For noen år siden skrev jeg et Python program. Programmet skulle sørge for å få meg flere Twitter følgere. Jeg vet, hvorfor skulle man lage et slikt program i det hele tatt? Det skal jeg ikke svare på nå, kanskje senere. Programmet hadde noen avhengigheter til Python moduler som jeg installerte med Pip. Jeg husker at installasjonen av Python og Pip ikke var rett fram. Ubuntu versjonen jeg brukte kom med Python 2, men jeg trengte Python 3 og en tilsvarende Pip versjon. Det tok noe tid før alt var på plass. Som ofte er det teknologier som man ikke bruker hver dag som vi bruker mest tid på. Jeg puttet derfor programmet inn ett Docker image. Slik unngikk jeg installasjon av Python, Pip og de andre modulene senere en gang til. 

To år senere trengte jeg dette programmet igjen. Jeg husket så vidt at jeg brukte Python og at jeg hadde puttet alt inn i et Docker image. Jeg hadde lagret imaget på min Docker Hub side, så jeg slapp å bruke mye tid på å finne ut av hvordan jeg skulle installere, konfigurere, starte og stoppe applikasjonen, dvs. Docker imaget. Det eneste jeg trengte å gjøre var å installere Docker på min maskin. Docker hjalp meg å komme raskt i gang. Men, hvordan ser det ut hos kundene våre som kjører de store prosjektene?
## Docker i mindre bedrifter
Hos kundene våre vil det nok ikke være så enkelt. De har for det meste andre og flere behov. Tjenestene krever ofte høy tilgjengelighet og trenger flere Docker hosts hvor det kan kjøres flere tjenesteinstanser i parallel. Kubernetes er en teknologie som kan hjelpe her. Kubernetes har vokst til en slags paraply for Docker og som er blitt veldig populær. I et høytilgjengeligmiljø kommer i tillegg til Kubernetes noen andre tekonologier, som for eksempel lastbalanserer, logging- og monitoreringsverktøy, konfigurasjonsstyringsverktøy. Det jeg vil si er følgende: Docker kommer sjeldent alene. En velfungerende Dockerplattform krever mye kunnskap om mange andre teknologier enn kun Docker. De aller fleste utviklere har mye kunnskap om Git, Maven og Jenkins, og mange av dem kan også skrive en Dockerfil. De som ikke kan det lærer det fort. Men, å drifte en Dockerplattform er en fulltidsjobb for to eller flere personer. Det er viktig å være bevist på det før man bestemmer seg for Docker. 
## Docker Plattform as a Service
Jeg påstår, og det er sikkert noen som er uenig med meg, at Docker som Plattform as a Service (DPaaS) er en forutsetning for at et kundeprosjekt kan bruke Docker. DPaas er en forutsetning at utviklerne kan fokusere 100% på forrettningskode. NAV har utviklet en slik plattform, NAIS - NAV Application Infrastructure Service. Plattformen består av Docker - selvfølgelig -, Kubernetes, Træfik, Grafana, InfluxDB og noen andre teknologier. NAIS vedlikeholdes av et team på 4-6 personer som sørger for at plattformen er enkelt å bruke og at den alltid er tilgjengelig. For de som deployer sine tjenester til NAIS, er plattformen en forenkling av hverdagen. Før NAIS ble utviklet, så måtte utviklerne deploye en tjenesteinstans til en egen JBoss server. JBoss kjørte selv på en egen host. Mange JBoss servere på mange hosts betyr mye konfigurasjon. Det betyr også mer ressursbruk og høyere kostnader. I dag, når vi ruller ut for eksempel fire tjenesteinstanser til NAIS, så sprees disse utover alle NAIS hosts, helautomatisk. Skulle en host ha problemer og må restartes - det betyr at Docker kontainerne som kjører applikasjonene vil stoppes - så starter NAIS disse på en annen host, også helautomatisk. 

DPaaS gjør at utviklerne er mindre avhengig av de har driftet JBoss før. I tillegg får viklerne mer ansvar. Dockerfilen som beskriver hvordan en applikasjon skal kjøre inn i en kontainer, er nå blitt en del av applikasjonsprosjektet. Filen ligger sammen med en NAIS konfigurasjonsfil og applikasjonskoden i prosjektet. Fordelen med det at alt ligger sammen i ett og samme prosjekt er at utviklerne vil ta full eierskap - you build it, you run it.

## Konklusjon
Jeg er glad for at jeg kan bruke Docker privat. Teknologien hjelper meg å ta være på mine applikasjoner. Jeg forholder meg til en teknologi. Hos kundene våre ønsker jeg helst et velfungerende og brukervennlig grensesnitt for Docker. Slik kan jeg fokusere på de tjenestene som skal lages. NAIS er en slik plattform. Den er veldig tilpasset NAV, men det kommer stadig flere tilsvarende Dockerplattformer, og som er minst like gøy å jobbe med.
